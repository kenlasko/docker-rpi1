var eInfo = document.getElementById("LoginStatus"), NagCount = 0; WL.Event.subscribe("auth.login", onLogin), WL.Event.subscribe("auth.sessionChange", onSessionChange), WL.init({ client_id: APP_CLIENT_ID, redirect_uri: REDIRECT_URL, scope: ["wl.signin", "wl.basic", "wl.emails"], response_type: "token" }), WL.ui({ name: "signin", element: "signin", type: "signin", brand: "windows", onloggedout: LogOut() }); var session = WL.getSession(); function LogOut() { eInfo.innerHTML = "Sign in with your Microsoft ID to get started!", document.getElementById("CreateRulesHeader").style.display = "none", document.getElementById("StartCreating").style.visibility = "hidden", document.getElementById("UserID").value = "", document.getElementById("UserID2").value = "", document.getElementById("UserID3").value = "" } function onLogin(e) { null != e ? e.error ? (eInfo.innerHTML = "Error signing in: " + e.error_description, document.getElementById("ReportsButton").style.display = "none", document.getElementById("UserID").value = "", document.getElementById("UserID2").value = "", document.getElementById("UserID3").value = "", $("#CreateRules").slideUp("slow"), document.getElementById("CreateRulesHeader").style.display = "none", document.getElementById("StartCreating").style.visibility = "hidden") : WL.api({ path: "me", method: "GET" }).then(function (e) { var t; document.getElementById("UserID").value = e.id, document.getElementById("UserID2").value = e.id, document.getElementById("UserID3").value = e.id, document.getElementById("UserFirstName").value = e.first_name, document.getElementById("UserLastName").value = e.last_name, document.getElementById("UserEmail").value = e.emails.account, $("#CreateRules").slideDown("slow"), document.getElementById("CreateRulesHeader").style.display = "", document.getElementById("StartCreating").style.visibility = "visible", eInfo.innerHTML = "You are logged in as <a href='" + e.link + "'; style='color: white;' target='_blank'>" + e.emails.account + "</a>", (t = new XMLHttpRequest).onreadystatechange = function () { if (4 == t.readyState && 200 == t.status) { var n = t.responseText, a = n.split(","), l = a[0].trim(); n = a[1]; var s = parseInt(a[2]), i = parseInt(a[3]); isNaN(i) && (i = "0"), isNaN(s) && (s = "0"), eInfo.innerHTML = "You are logged in as <a href='" + e.link + "'; style='color: white;' target='_blank'>" + e.emails.account + "</a><br>You have generated " + s + " rulesets and have donated a total of $" + i, "d08e7a1fea6a8938" == e.id && (eInfo.innerHTML = "You are logged in as <a href='" + e.link + "'; style='color: white;' target='_blank'>" + e.emails.account + "</a><br>You have generated " + s + " rulesets and have donated a total of $" + i + ". Why don't you dig around in that crusty beard of yours and pull out some more cash, you cheap bastard?"), "15afc3e7fae23c61" == e.id && (eInfo.innerHTML = "You are logged in as <a href='" + e.link + "'; style='color: white;' target='_blank'>" + e.emails.account + "</a><br>You have generated " + s + " rulesets and have donated a total of $" + i + ". Not bad. If you could stop flying all over the world in search of Duran Duran concerts, maybe you'd have enough to help me keep this going, you bald-headed, inked-up motherfucker!"), "" == n && s > 19 && NagCount < 1 && ($.magnificPopup.open({ items: { src: "<div class='warning-popup'><H4><strong>WARNING</strong></H4><P>It appears that you've created " + s + " rulesets with UCDialPlans.com and have never donated.  Please consider donating by clicking the PayPal link at the bottom of the page.</P><P><form style='margin-left: 5.5em;' action='https://www.paypal.com/cgi-bin/webscr' method='post'><input type='hidden' name='cmd' value='_s-xclick'><input type='hidden' name='encrypted' value='-----BEGIN PKCS7-----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-----END PKCS7-----'><input type='image' style='width: 15em; height: auto;' src='https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif' border='none' name='PayPal' alt='PayPal - The safer, easier way to pay online!'><img alt='' border='none' src='https://www.paypalobjects.com/en_US/i/scr/pixel.gif' width='1' height='1'></form></p></div>", type: "inline" }, closeOnContentClick: !1 }), NagCount = 1), "Admin" == l ? document.getElementById("ReportsButton").style.display = "" : document.getElementById("ReportsButton").style.display = "none" } }, t.open("GET", "QueryDB.cshtml?Query=DonationCount&ID=" + document.InputForm.UserID.value, !0), t.setRequestHeader("X-Requested-With", "XMLHttpRequest"), t.send() }, function (e) { eInfo.innerHTML = "Error calling API: " + e.error.message, document.getElementById("ReportsButton").style.display = "none", document.getElementById("UserID").value = "", document.getElementById("UserID2").value = "", document.getElementById("UserID3").value = "", $("#CreateRules").slideUp("slow"), document.getElementById("CreateRulesHeader").style.display = "none" }) : (eInfo.innerHTML = "Sign in with your Microsoft ID to get started!", document.getElementById("ReportsButton").style.display = "none", document.getElementById("UserID").value = "", document.getElementById("UserID2").value = "", document.getElementById("UserID3").value = "", $("#CreateRules").slideUp("slow"), document.getElementById("CreateRulesHeader").style.display = "none", document.getElementById("StartCreating").style.visibility = "hidden") } function onSessionChange() { WL.getSession() ? eInfo.innerText = "Something about the session changed." : (eInfo.innerText = "Signed out or session error.", document.getElementById("ReportsButton").style.display = "none", document.getElementById("UserID").value = "", document.getElementById("UserID2").value = "", document.getElementById("UserID3").value = "", $("#CreateRules").slideUp("slow"), document.getElementById("CreateRulesHeader").style.display = "none", document.getElementById("StartCreating").style.visibility = "hidden") } session || (eInfo.innerHTML = "Sign in with your Microsoft ID to get started!", document.getElementById("CreateRulesHeader").style.display = "none", document.getElementById("StartCreating").style.visibility = "hidden", document.getElementById("UserID").value = "", document.getElementById("UserID2").value = "", document.getElementById("UserID3").value = ""), onLogin(session);